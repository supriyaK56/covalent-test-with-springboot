{"version":3,"file":"chart-line.component.js","sourceRoot":"","sources":["chart-line.component.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAA,OAAO,EAAE,SAAS,EAAE,KAAK,EAAE,MAAM,EAAE,UAAU,EAAE,MAAM,eAAe,CAAC;AACrE,OAAO,EAAE,gBAAgB,EAAE,MAAM,iBAAiB,CAAC;AACnD,OAAO,EAAE,iBAAiB,EAAE,MAAM,qBAAqB,CAAC;AACxD,OAAO,EAAE,cAAc,EAAc,MAAM,6BAA6B,CAAC;AAEzE,8BAA8B;AAC9B,IAAI,EAAE,GAAQ,OAAO,CAAC,IAAI,CAAC,CAAC;AAO5B,IAAa,oBAAoB;IAAS,wCAAc;IAmBtD,8BAAyD,MAAyB,EAC9D,iBAAmC;QADvD,YAEE,kBAAM,MAAM,CAAC,SACd;QAFmB,uBAAiB,GAAjB,iBAAiB,CAAkB;QAV9C,gBAAU,GAAW,EAAE,CAAC;QACxB,gBAAU,GAAY,IAAI,CAAC;QAC3B,wBAAkB,GAAW,CAAC,CAAC;QAC/B,qBAAe,GAAW,CAAC,CAAC;QAE5B,YAAM,GAAa,CAAC,SAAS,EAAE,SAAS,EAAE,SAAS,CAAC,CAAC;QAErD,gBAAU,GAAY,KAAK,CAAC;;IAKrC,CAAC;IAnBD,sBAAI,yCAAO;aAAX,UAAY,OAAe;YACzB,iBAAM,UAAU,YAAC,OAAO,CAAC,CAAC;QAC5B,CAAC;;;OAAA;IAED,sBAAI,sCAAI;aAAR,UAAS,IAAkB;YACzB,iBAAM,OAAO,YAAC,IAAI,CAAC,CAAC;QACtB,CAAC;;;OAAA;IAeD,0CAAW,GAAX,UAAY,IAAS;QAArB,iBAwFC;QAvFC,IAAI,CAAC,GAAQ,EAAE,CAAC,UAAU,EAAE;aACnB,QAAQ,CAAC,IAAI,CAAC,kBAAkB,CAAC;aACjC,KAAK,CAAC,IAAI,CAAC,eAAe,CAAC;aAC3B,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC;QAE7B,IAAI,SAAS,GAAQ,EAAE,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;QAC9C,IAAI,SAAS,GAAQ,UAAS,MAAW,EAAE,UAAkB,IAAY,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;QACtG,IAAI,OAAO,GAAQ,UAAS,MAAW,EAAE,UAAkB,IAAU,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAE7G,IAAI,GAAG,GAAa,IAAI,CAAC,UAAU,GAAG,OAAO,GAAG,SAAS,CAAC;QAC1D,IAAI,MAAM,GAAa,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC,SAAS,GAAG,EAAE,CAAC,WAAW,CAAC;QACvE,IAAI,MAAM,GAAW,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAE/C,IAAI,CAAC,GAAQ,MAAM,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE,IAAI,CAAC,OAAO,CAAC,KAAK,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QAC7E,IAAI,CAAC,GAAQ,EAAE,CAAC,WAAW,EAAE,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC;QAC9D,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;QACZ,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;QAEZ,IAAI,KAAK,GAAQ,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QAE9C,IAAI,QAAQ,GAAQ,EAAE,CAAC,IAAI,EAAE;aAC1B,CAAC,CAAC,UAAC,CAAM,IAAO,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;aACtC,CAAC,CAAC,UAAC,CAAM,IAAO,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAE1C,IAAI,KAAK,GAAU,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,UAAC,EAAO;YAC1C,MAAM,CAAC;gBACL,EAAE,EAAE,EAAE;gBACN,MAAM,EAAE,IAAI,CAAC,GAAG,CAAC,UAAC,CAAM;oBACtB,MAAM,CAAC,EAAC,MAAM,EAAE,GAAG,CAAC,CAAC,EAAE,KAAI,CAAC,UAAU,CAAC,EAAE,MAAM,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,EAAC,CAAC;gBAC3D,CAAC,CAAC;aACH,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC,MAAM,CAAC,IAAI,EAAE,UAAC,CAAM,IAAO,MAAM,CAAC,GAAG,CAAC,CAAC,EAAE,KAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAE3E,CAAC,CAAC,MAAM,CAAC;YACP,EAAE,CAAC,GAAG,CAAC,KAAK,EAAE,UAAC,CAAM,IAAO,MAAM,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,MAAM,EAAE,UAAC,CAAM,IAAO,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzF,EAAE,CAAC,GAAG,CAAC,KAAK,EAAE,UAAC,CAAM,IAAO,MAAM,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,MAAM,EAAE,UAAC,CAAM,IAAO,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;SAC1F,CAAC,CAAC;QAEH,IAAI,MAAM,GAAW,IAAI,CAAC,OAAO,CAAC,aAAa,EAAE,CAAC;QAElD,IAAI,GAAG,GAAQ,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;QAEtE,IAAI,IAAI,GAAQ,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC;aAC5B,OAAO,CAAC,aAAa,EAAE,IAAI,CAAC;aAC5B,SAAS,CAAC,YAAY,CAAC;aACvB,IAAI,CAAC,KAAK,CAAC;aACX,KAAK,EAAE,CAAC;QAEX,IAAI,cAAc,GAAY,IAAI,CAAC,UAAU,CAAC;QAE9C,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;aAChB,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC;aACrB,KAAK,CAAC,IAAI,CAAC;aACX,IAAI,CAAC,GAAG,EAAE,UAAC,CAAM,IAAO,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;aACrD,KAAK,CAAC,QAAQ,EAAE,UAAC,CAAM,IAAO,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;aACpD,IAAI,CAAC,kBAAkB,EAAE,UAAS,CAAM;YACvC,EAAE,CAAC,CAAC,cAAc,KAAK,IAAI,CAAC,CAAC,CAAC;gBAC5B,MAAM,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC;YAC/B,CAAC;QACH,CAAC,CAAC;aACD,IAAI,CAAC,mBAAmB,EAAE,UAAS,CAAM;YACxC,EAAE,CAAC,CAAC,cAAc,KAAK,IAAI,CAAC,CAAC,CAAC;gBAC5B,MAAM,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC;YAC/B,CAAC;QACH,CAAC,CAAC;aACD,KAAK,CAAC,QAAQ,EAAE,MAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC,QAAQ,GAAG,GAAG,GAAG,MAAM,GAAG,GAAG,CAAC,CAAC;QAElF,EAAE,CAAC,CAAC,IAAI,CAAC,UAAU,KAAK,IAAI,CAAC,CAAC,CAAC;YAC7B,GAAG,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;iBAC/B,IAAI,CAAC,mBAAmB,EAAE,CAAC,CAAC,CAAC;QACpC,CAAC;QAED,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;aAChB,KAAK,CAAC,UAAC,CAAM,IAAO,MAAM,CAAC,EAAC,EAAE,EAAE,CAAC,CAAC,EAAE,EAAE,KAAK,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC,CAAC;aAC/E,IAAI,CAAC,WAAW,EAAE,UAAC,CAAM;YACxB,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;gBACb,MAAM,CAAC,SAAS,CAAC;YACnB,CAAC;YAAC,IAAI,CAAC,CAAC;gBACN,MAAM,CAAC,YAAY,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,GAAG,CAAC;YAC1E,CAAC;QACH,CAAC,CAAC;aACD,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC;aACZ,IAAI,CAAC,IAAI,EAAE,QAAQ,CAAC;aACpB,KAAK,CAAC,MAAM,EAAE,iBAAiB,CAAC;aAChC,IAAI,CAAC,UAAC,CAAM,EAAE,CAAS,IAAO,MAAM,CAAC,KAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC7D,CAAC;IACH,2BAAC;AAAD,CAAC,AAjHD,CAA0C,cAAc,GAiHvD;AA9GC;IADC,KAAK,EAAE;;;mDAGP;AAED;IADC,KAAK,EAAE;;;gDAGP;AACQ;IAAR,KAAK,EAAE;;wDAAyB;AACxB;IAAR,KAAK,EAAE;;wDAA4B;AAC3B;IAAR,KAAK,EAAE;;gEAAgC;AAC/B;IAAR,KAAK,EAAE;;6DAA6B;AAC5B;IAAR,KAAK,EAAE;;qDAAmB;AAClB;IAAR,KAAK,EAAE;;oDAAsD;AACrD;IAAR,KAAK,EAAE;;oDAAkB;AACjB;IAAR,KAAK,EAAE;;wDAA6B;AAjB1B,oBAAoB;IALhC,SAAS,CAAC;QACT,QAAQ,EAAE,eAAe;QACzB,SAAS,EAAE,CAAC,4BAA4B,CAAC;QACzC,WAAW,EAAE,6BAA6B;KAC3C,CAAC;IAoBa,WAAA,MAAM,CAAC,UAAU,CAAC,cAAM,OAAA,iBAAiB,EAAjB,CAAiB,CAAC,CAAC,CAAA;qCAAS,iBAAiB;QAC3C,gBAAgB;GApB5C,oBAAoB,CAiHhC;SAjHY,oBAAoB","sourcesContent":["import { Component, Input, Inject, forwardRef } from '@angular/core';\nimport { PlatformLocation } from '@angular/common';\nimport { TdChartsComponent } from '../charts.component';\nimport { ChartComponent, IChartData } from '../abstract-chart.component';\n\n/* tslint:disable-next-line */\nlet d3: any = require('d3');\n\n@Component({\n  selector: 'td-chart-line',\n  styleUrls: ['./chart-line.component.css'],\n  templateUrl: './chart-line.component.html',\n})\nexport class TdChartLineComponent extends ChartComponent {\n\n  @Input()\n  set dataSrc(dataSrc: string) {\n    super.setDataSrc(dataSrc);\n  }\n  @Input()\n  set data(data: IChartData[]) {\n    super.setData(data);\n  }\n  @Input() bottomAxis: string = '';\n  @Input() transition: boolean = true;\n  @Input() transitionDuration: number = 0;\n  @Input() transitionDelay: number = 0;\n  @Input() columns: string[];\n  @Input() colors: string[] = ['#304FFE', '#00B8D4', '#FF3D00'];\n  @Input() titles: string[];\n  @Input() timeSeries: boolean = false;\n\n  constructor(@Inject(forwardRef(() => TdChartsComponent)) parent: TdChartsComponent,\n              private _platformLocation: PlatformLocation) {\n    super(parent);\n  }\n\n  renderChart(data: any): void {\n    let t: any = d3.transition()\n            .duration(this.transitionDuration)\n            .delay(this.transitionDelay)\n            .ease(d3.easeLinear);\n\n    let parseTime: any = d3.timeParse('%d-%b-%y');\n    let stringCol: any = function(record: any, bottomAxis: string): string { return record[bottomAxis]; };\n    let dateCol: any = function(record: any, bottomAxis: string): Date { return parseTime(record[bottomAxis]); };\n\n    let row: Function = this.timeSeries ? dateCol : stringCol;\n    let xScale: Function = this.timeSeries ? d3.scaleTime : d3.scaleLinear;\n    let offset: number = this._parent.offset(data);\n\n    let x: any = xScale().range([offset / 2, this._parent.width - (offset / 2)]);\n    let y: any = d3.scaleLinear().range([this._parent.height, 0]);\n    this._x = x;\n    this._y = y;\n\n    let color: any = d3.scaleOrdinal(this.colors);\n\n    let drawLine: any = d3.line()\n      .x((d: any) => { return x(d.xValue); })\n      .y((d: any) => { return y(d.yValue); });\n\n    let lines: any[] = this.columns.map((id: any) => {\n      return {\n        id: id,\n        values: data.map((d: any) => {\n          return {xValue: row(d, this.bottomAxis), yValue: +d[id]};\n        }),\n      };\n    });\n\n    x.domain(d3.extent(data, (d: any) => { return row(d, this.bottomAxis); }));\n\n    y.domain([\n      d3.min(lines, (c: any) => { return d3.min(c.values, (d: any) => { return d.yValue; }); }),\n      d3.max(lines, (c: any) => { return d3.max(c.values, (d: any) => { return d.yValue; }); }),\n    ]);\n\n    let defsId: string = this._parent.drawContainer();\n\n    let svg: any = d3.select(this._parent.container).selectAll('.chartG');\n\n    let line: any = svg.append('g')\n      .classed('chart-lines', true)\n      .selectAll('.lineTitle')\n      .data(lines)\n      .enter();\n\n    let transitionFlag: boolean = this.transition;\n\n    line.append('path')\n      .attr('class', 'line')\n      .merge(line)\n      .attr('d', (d: any) => { return drawLine(d.values); })\n      .style('stroke', (d: any) => { return color(d.id); })\n      .attr('stroke-dasharray', function(d: any): number {\n        if (transitionFlag === true) {\n          return this.getTotalLength();\n        }\n      })\n      .attr('stroke-dashoffset', function(d: any): number {\n        if (transitionFlag === true) {\n          return this.getTotalLength();\n        }\n      })\n      .style('filter', 'url(' + this._platformLocation.pathname + '#' + defsId + ')');\n\n    if (this.transition === true) {\n      svg.selectAll('.line').transition(t)\n          .attr('stroke-dashoffset', 0);\n    }\n\n    line.append('text')\n      .datum((d: any) => { return {id: d.id, value: d.values[d.values.length - 1]}; })\n      .attr('transform', (d: any) => {\n        if (!d.value) {\n          return undefined;\n        } else {\n          return 'translate(' + x(d.value.xValue) + ',' + y(d.value.yValue) + ')';\n        }\n      })\n      .attr('x', 3)\n      .attr('dy', '0.35em')\n      .style('font', '10px sans-serif')\n      .text((d: any, i: number) => { return this.titles[i]; });\n  }\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}