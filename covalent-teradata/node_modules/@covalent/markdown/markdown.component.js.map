{"version":3,"file":"markdown.component.js","sourceRoot":"","sources":["markdown.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, AfterViewInit, ElementRef, Input, Renderer, SecurityContext } from '@angular/core';\nimport { DomSanitizer } from '@angular/platform-browser';\n\ndeclare var showdown: any;\n\n@Component({\n  selector: 'td-markdown',\n  styleUrls: ['./markdown.component.css'],\n  templateUrl: './markdown.component.html',\n})\nexport class TdMarkdownComponent implements AfterViewInit {\n\n  private _content: string;\n\n  /**\n   * content?: string\n   *\n   * Markdown format content to be parsed as html markup.\n   * Used to load data dynamically.\n   *\n   * e.g. README.md content.\n   */\n  @Input('content')\n  set content(content: string) {\n    this._content = content;\n    this._loadContent(this._content);\n  }\n\n  constructor(private _renderer: Renderer,\n              private _elementRef: ElementRef,\n              private _domSanitizer: DomSanitizer) {}\n\n  ngAfterViewInit(): void {\n    if (!this._content) {\n      this._loadContent((<HTMLElement>this._elementRef.nativeElement).textContent);\n    }\n  }\n\n  /**\n   * General method to parse a string markdown into HTML Elements and load them into the container\n   */\n  private _loadContent(markdown: string): void {\n    if (markdown && markdown.trim().length > 0) {\n      // Parse html string into actual HTML elements.\n      let divElement: HTMLDivElement = this._elementFromString(this._render(markdown));\n      // Clean container\n      this._renderer.setElementProperty(this._elementRef.nativeElement, 'innerHTML', '');\n      // Project DIV element into container\n      this._renderer.projectNodes(this._elementRef.nativeElement, [divElement]);\n    }\n  }\n\n  private _elementFromString(markupStr: string): HTMLDivElement {\n    // Renderer doesnt have a parsing method, so we have to sanitize and use [innerHTML]\n    // to parse the string into DOM element for now.\n    const div: HTMLDivElement = this._renderer.createElement(this._elementRef.nativeElement, 'div');\n    div.innerHTML = this._domSanitizer.sanitize(SecurityContext.HTML, markupStr);\n    return div;\n  }\n\n  private _render(markdown: string): string {\n    // Trim leading and trailing newlines\n    markdown = markdown.replace(/^(\\s|\\t)*\\n+/g, '')\n                       .replace(/(\\s|\\t)*\\n+(\\s|\\t)*$/g, '');\n    // Split markdown by line characters\n    let lines: string[] = markdown.split('\\n');\n\n    // check how much indentation is used by the first actual markdown line\n    let firstLineWhitespace: string = lines[0].match(/^(\\s|\\t)*/)[0];\n\n    // Remove all indentation spaces so markdown can be parsed correctly\n    let startingWhitespaceRegex: RegExp = new RegExp('^' + firstLineWhitespace);\n    lines = lines.map(function(line: string): string {\n      return line.replace(startingWhitespaceRegex, '');\n    });\n\n    // Join lines again with line characters\n    let markdownToParse: string =  lines.join('\\n');\n\n    // Convert markdown into html\n    let converter: any = new showdown.Converter();\n    converter.setOption('ghCodeBlocks', true);\n    converter.setOption('tasklists', true);\n    converter.setOption('tables', true);\n    let html: string = converter.makeHtml(markdownToParse);\n    return html;\n  }\n\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}